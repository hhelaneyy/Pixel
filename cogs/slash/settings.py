import random
import disnake
from disnake.ext import commands
import sqlite3
from core.utilities.embeds import footer
from cogs.events.locale import Locale

conn = sqlite3.connect('Pixel.db')
cursor = conn.cursor()

cursor.execute('''
            CREATE TABLE IF NOT EXISTS locales (
            user_id TEXT PRIMARY KEY, 
            language TEXT
             )
        ''')
conn.commit()

cursor.execute('''
    CREATE TABLE IF NOT EXISTS voices (
    guild_id INTEGER PRIMARY KEY,
    channel_id INTEGER
    )
''')
conn.commit()

cursor.execute('''
    CREATE TABLE IF NOT EXISTS user_voices (
    id INTEGER PRIMARY KEY,
    guild_id INTEGER,
    user_id INTEGER,
    channel_id INTEGER
    )
''')
conn.commit()

cursor.execute('''
               CREATE TABLE IF NOT EXISTS logs (
               guild_id INTEGER PRIMARY KEY,
               channel_id INTEGER
               )
''')
conn.commit()

cursor.execute('''
               CREATE TABLE IF NOT EXISTS auto_roles (
               guild_id INTEGER PRIMARY KEY,
               guild_name TEXT,
               role_id INTEGER
               )
               ''')
conn.commit()

cursor.execute('''
               CREATE TABLE IF NOT EXISTS prefix (
               user_id INTEGER PRIMARY KEY,
               prefix_name TEXT
               )
               ''')
conn.commit()

cursor.execute('''
         CREATE TABLE IF NOT EXISTS autothread (
               id INTEGER PRIMARY KEY,
               guild_id INTEGER NOT NULL,
               guild_name TEXT,
               channel_id INTEGER NOT NULL
)
''')
conn.commit()

cursor.execute('''
               CREATE TABLE IF NOT EXISTS atembed (
               id INTEGER PRIMARY KEY,
               guild_id INTEGER NOT NULL,
               guild_name TEXT,
               channel_id INTEGER NOT NULL,
               name TEXT,
               title TEXT,
               description TEXT,
               color INTEGER
)
''')
conn.commit()

cursor.execute('''
            CREATE TABLE IF NOT EXISTS lkroles (
            guild_id INTEGER PRIMARY KEY,
            role_id INTEGER
        )
''')

class SettingsCog(commands.Cog):
    def __init__(self, bot: commands.Bot):
        self.bot = bot
        self.locale = Locale(bot)

    @commands.slash_command(description="–ù–∞—Å—Ç—Ä–æ–π-–∫–∞ –º–µ–Ω—è, –°–µ–Ω-–ø–∞–π u-u.")
    async def settings(self, inter):
        ...

    @commands.slash_command(description='–û—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ –º–Ω–µ –≥–æ–ª–æ—Å–æ–≤—É—Ö—É. / Organize a voice for me.')
    async def voice(self, inter):
        ...

    @settings.sub_command(name='logs', description='–ë—É–¥—É –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –Ω–∞—à –ø—Ä–∞–∑–¥–Ω–∏–∫ –≤–µ—á–Ω–æ—Å—Ç—å!')
    @commands.has_permissions(administrator=True)
    async def logs(self, inter: disnake.ApplicationCommandInteraction, action: str = commands.Param(choices=['–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å –∫–∞–Ω–∞–ª', '–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª']), channel: disnake.TextChannel = None):
        guild_id = inter.guild.id

        if action == '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å –∫–∞–Ω–∞–ª':
            if channel:
                cursor.execute('SELECT channel_id FROM logs WHERE guild_id = ?', (guild_id,))
                exc_channel_id = cursor.fetchone()

            if exc_channel_id:
                cursor.execute('UPDATE logs SET channel_id = ? WHERE guild_id = ?', (channel.id, guild_id))
                conn.commit()

                titl = 'üîÑÔ∏è –ö–∞–Ω–∞–ª –ª–æ–≥–æ–≤ –∏–∑–º–µ–Ω—ë–Ω'
                act = '–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–º–µ–Ω—ã –ø—Ä–æ—à–ª–æ–≥–æ –∫–∞–Ω–∞–ª–∞.'
                clr = 0xF2FC58
            else:
                cursor.execute('INSERT INTO logs (guild_id, channel_id) VALUES (?, ?)', (guild_id, channel.id))
                conn.commit()

                titl = '‚úÖ –ö–∞–Ω–∞–ª –ª–æ–≥–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'
                act = '–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª –ª–æ–≥–æ–≤.'
                clr = 0x84FE9A

            E = disnake.Embed(title=titl, color=clr)
            E.add_field(name='–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞:', value=channel.mention)
            E.add_field(name='–î–µ–π—Å—Ç–≤–∏–µ:', value=act)
            E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
            await inter.response.send_message(embed=E)
        
        elif action == '–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª' and channel is None:
            cursor.execute('DELETE FROM logs WHERE guild_id = ?', (guild_id,))
            conn.commit()

            E = disnake.Embed(title='üö´ –ö–∞–Ω–∞–ª –ª–æ–≥–æ–≤ —É–¥–∞–ª—ë–Ω.', color=0xe52f07)
            E.add_field(name='–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã:', value=f'```–ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —ç—Ç–æ–º —Å–µ—Ä–≤–µ—Ä–µ –±–æ–ª–µ–µ –Ω–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è.```')
            E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
            await inter.response.send_message(embed=E)

    @voice.sub_command(name='create', description='–ì–æ–ª–æ—Å–æ–≤–æ–π –¥–ª—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö? –ó–≤—É—á–∏—Ç... —Å—Ç—Ä–∞–Ω–Ω–æ. / Voice for voice? Sounds... weird.')
    @commands.has_permissions(manage_channels=True)
    async def create(self, inter: disnake.ApplicationCommandInteraction, action: str = commands.Param(choices=['–°–æ–∑–¥–∞—Ç—å / Create', '–£–¥–∞–ª–∏—Ç—å / Delete']), *, channel_name: str = '–°–æ–∑–¥–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–∞–Ω–∞–ª'):
        await inter.response.defer()
        guild = inter.guild

        if action == '–°–æ–∑–¥–∞—Ç—å / Create':
            chan = await guild.create_voice_channel(name=channel_name, user_limit=1)

            cursor.execute('INSERT INTO voices (guild_id, channel_id) VALUES (?, ?)', (guild.id, chan.id))
            conn.commit()

            voice = await self.locale.get_translation(inter.author.id, 'voice_create')
            footer = await self.locale.get_translation(inter.author.id, 'footer')

            E = disnake.Embed(title=voice['title'], color=0xd0f594)
            E.add_field(name='', value=voice['field'].format(channel_mention=chan.mention))
            E.set_footer(text=random.choice(footer), icon_url=guild.icon)
            await inter.followup.send(embed=E)

        else:
            cursor.execute('SELECT channel_id FROM voices WHERE guild_id = ?', (guild.id,))
            chan = cursor.fetchone()
            chan2 = chan[0]

            channel = guild.get_channel(chan2)
            cursor.execute('DELETE FROM voices WHERE guild_id = ?', (guild.id,))
            conn.commit()
            await channel.delete()
            await inter.followup.send('‚úÖ', ephemeral=True)

    @voice.sub_command(name='join', description='–ù—É –Ω–µ –±—É–¥–µ—Ç–µ –∂–µ –≤—ã –æ–¥–∏–Ω —Å–∏–¥–µ—Ç—å, –¥–∞? / Well, you won‚Äôt sit alone, right?')
    async def allow(self, inter: disnake.ApplicationCommandInteraction, action: str = commands.Param(choices=['–†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥ / Allow join', '–ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Ö–æ–¥ / Deny join']), *, user: disnake.Member):
        cursor.execute('SELECT channel_id FROM user_voices WHERE guild_id = ? AND user_id = ?', (inter.guild.id, inter.author.id))
        channel_row = cursor.fetchone()

        if channel_row:
            channel_id = channel_row[0]

            voice = await self.locale.get_translation(inter.author.id, 'voice_allow_deny')

            if action == '–†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥ / Allow join':
                chan = inter.guild.get_channel(channel_id)
                await chan.set_permissions(user, move_members=True, speak=True)
                await inter.response.send_message(voice['allow'].format(user=user.mention, channel=chan.mention))

            elif action == '–ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Ö–æ–¥ / Deny join':
                chan = inter.guild.get_channel(channel_id)
                await chan.set_permissions(user, move_members=False, speak=True)
                await inter.response.send_message(voice['deny'])

        else:
            await inter.response.send_message(voice['no_channel'])

    @settings.sub_command(name='user-lang', description="–•–æ—á–µ—à—å, –±—É–¥–µ–º –æ–±—â–∞—Ç—å—Å—è –Ω–∞ —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–æ–º? / Do you want us to communicate in French?")
    async def set_lang(self, inter: disnake.ApplicationCommandInteraction, language: str = commands.Param(choices=['–†—É—Å—Å–∫–∏–π', 'English'])):
        language_code = "ru" if language.lower() == "—Ä—É—Å—Å–∫–∏–π" else "en"
        cursor.execute("REPLACE INTO locales (user_id, language) VALUES (?, ?)",
                       (str(inter.author.id), language_code))
        conn.commit()

        trans = await self.locale.get_translation(inter.author.id, 'locale')
        footer = await self.locale.get_translation(inter.author.id, "footer")

        E = disnake.Embed(title=trans[0], color=0x9bf8e0)
        E.add_field(name=trans[1], value=f'```{trans[2].format(language=language)}```')
        E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
        await inter.response.send_message(embed=E, ephemeral=True)

    @settings.sub_command(name='autorole', description='–°—Ç–∞—Ç—É—Å—ã –¥–ª—è –≥–æ—Å—Ç–µ–π? –ö–∞–∫ –º–∏–ª–æ!')
    @commands.has_permissions(administrator=True)
    async def auto_role(self, inter: disnake.ApplicationCommandInteraction, action: str = commands.Param(choices=['–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å', '–£–¥–∞–ª–∏—Ç—å —Ä–æ–ª—å']), *, role: disnake.Role = None):
        guild_id = inter.guild.id
        guild_name = inter.guild.name

        if action == '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å':
            if role:
                cursor.execute('SELECT role_id FROM auto_roles WHERE guild_id = ?', (guild_id,))
                role_id = cursor.fetchone()

            if role_id:
                cursor.execute('UPDATE auto_roles SET role_id = ? WHERE guild_id = ?', (role.id, guild_name))
                conn.commit()

                titl = 'üîÑÔ∏è –ê–≤—Ç–æ-—Ä–æ–ª—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞.'
                act = f'{role.mention} –±—ã–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –∫–∞–∫ –Ω–æ–≤–∞—è –∞–≤—Ç–æ-—Ä–æ–ª—å.'
                clr = 0xF2FC58
            else:
                cursor.execute('INSERT INTO auto_roles (guild_id, guild_name, role_id) VALUES (?, ?, ?)', (guild_id, guild_name, role.id))
                conn.commit()

                titl = '‚úÖ –ê–≤—Ç–æ-—Ä–æ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.'
                act = f'{role.mention} —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å—Å—è –∫–∞–∂–¥–æ–º—É –Ω–æ–≤–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É –≤–µ—á–µ—Ä–∏–Ω–∫–∏.'
                clr = 0x84FE9A

            E = disnake.Embed(title=titl, color=clr)
            E.add_field(name='–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ä–æ–ª—å:', value=role.mention)
            E.add_field(name='–î–µ–π—Å—Ç–≤–∏–µ:', value=act)
            E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
            await inter.response.send_message(embed=E)
        
        elif action == '–£–¥–∞–ª–∏—Ç—å —Ä–æ–ª—å' and role is None:
            cursor.execute('DELETE FROM auto_roles WHERE guild_id = ?', (guild_id,))
            conn.commit()

            E = disnake.Embed(title='üö´ –ê–≤—Ç–æ-—Ä–æ–ª—å —É–¥–∞–ª–µ–Ω–∞.', color=0xe52f07)
            E.add_field(name='–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã:', value=f'```–ù–æ–≤—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≤–µ—á–µ—Ä–∏–Ω–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –±—É–¥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —Ä–æ–ª—å –ø—Ä–∏ –ø–æ—Å–µ—â–µ–Ω–∏–∏.```')
            E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
            await inter.response.send_message(embed=E)

    @settings.sub_command(name='lockdown-role', description='–ê –∫–æ–º—É —è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞–ø—Ä–µ—â—É —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å?')
    @commands.has_permissions(administrator=True)
    async def ldrole(self, inter: disnake.ApplicationCommandInteraction, role: disnake.Role):
        await inter.response.defer()

        cursor.execute('SELECT role_id FROM lkroles WHERE guild_id = ?', (inter.guild.id,))
        r1 = cursor.fetchone()

        if r1:
            cursor.execute('UPDATE lkroles SET role_id = ? WHERE guild_id = ?', (role.id, inter.guild.id))
            conn.commit

            E = disnake.Embed(title='üü¢ –†–æ–ª—å —É—Å–ø–µ—à–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞', color=0x8eff77)
            E.add_field(name='–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã:', value=f'```–¢–µ–ø–µ—Ä—å —Ä–æ–ª—å "{role.name}" –±—É–¥–µ—Ç –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ (–≤ –∫–∞–Ω–∞–ª–∞—Ö –∏–º–µ–µ—Ç—Å—è –≤ –≤–∏–¥—É, –∞ –≤—ã –æ —á—ë–º –ø–æ–¥—É–º–∞–ª–∏?).```')
            E.set_footer(text=random.choice(footer), icon_url=inter.guild.icon)
            await inter.followup.send(embed=E)
        else:
            cursor.execute('INSERT INTO lkroles (guild_id, role_id) VALUES (?, ?)', (inter.guild.id, role.id))
            conn.commit()
            
            E = disnake.Embed(title='üü¢ –†–æ–ª—å —É—Å–ø–µ—à–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞', color=0x8eff77)
            E.add_field(name='–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã:', value=f'```–¢–µ–ø–µ—Ä—å —Ä–æ–ª—å "{role.name}" –±—É–¥–µ—Ç –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ (–≤ –∫–∞–Ω–∞–ª–∞—Ö –∏–º–µ–µ—Ç—Å—è –≤ –≤–∏–¥—É, –∞ –≤—ã –æ —á—ë–º –ø–æ–¥—É–º–∞–ª–∏?).```')
            E.set_footer(text=random.choice(footer), icon_url=inter.guild.icon)
            await inter.followup.send(embed=E)

    @settings.sub_command(name='prefix', description='–•–æ—Ç–∏—Ç–µ –ø—Ä–∏–¥—É–º–∞—Ç—å –¥–ª—è –º–µ–Ω—è –ø–æ–∑—ã–≤–Ω–æ–π?')
    async def prefix(self, inter: disnake.ApplicationCommandInteraction, action: str = commands.Param(choices=['–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å', '–£–¥–∞–ª–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å']), *, prefix: str = None):
        if action == '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å':
            if prefix:
                cursor.execute('SELECT prefix_name FROM prefix WHERE user_id = ?', (inter.author.id, ))
                prefix_name = cursor.fetchone()

            if prefix_name:
                cursor.execute('UPDATE prefix SET prefix_name = ? WHERE user_id = ?', (prefix, inter.author.id))
                conn.commit()

                titl = 'üîÑÔ∏è –ü—Ä–µ—Ñ–∏–∫—Å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω.'
                act = f'{prefix} –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∫–∞–∫ –Ω–æ–≤—ã–π –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª—è –≤–∞—Å.'
                clr = 0xF2FC58
            else:
                cursor.execute('INSERT INTO prefix (user_id, prefix_name) VALUES (?, ?)', (inter.author.id, prefix))
                conn.commit()

                titl = '‚úÖ –ê–≤—Ç–æ-—Ä–æ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.'
                act = f'–¢–µ–ø–µ—Ä—å, –ø—Ä–∏ –ø–æ–º–æ—â–∏ {prefix} –≤—ã —Å–º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∏ –∫–æ–º–∞–Ω–¥—ã.'
                clr = 0x84FE9A

            E = disnake.Embed(title=titl, color=clr)
            E.add_field(name='–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å:', value=prefix, inline=False)
            E.add_field(name='–î–µ–π—Å—Ç–≤–∏–µ:', value=act)
            E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
            await inter.response.send_message(embed=E, ephemeral=True)

        elif action == '–£–¥–∞–ª–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å' and prefix is None:
            cursor.execute('SELECT prefix_name FROM prefix WHERE user_id = ?', (inter.author.id, ))
            prefix_n1 = cursor.fetchone()

            if prefix_n1:
                cursor.execute('DELETE FROM prefix WHERE user_id = ?', (inter.author.id,))
                conn.commit()

                E = disnake.Embed(title='üö´ –ü—Ä–µ—Ñ–∏–∫—Å —É–¥–∞–ª–µ–Ω.', color=0xe52f07)
                E.add_field(name='–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã:', value=f'```–û—Ç–Ω—ã–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–µ—Ñ–∏–∫—Å –≤–Ω–æ–≤—å px-```')
                E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
                await inter.response.send_message(embed=E, ephemeral=True)

    @settings.sub_command(name='autothread', description='–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–µ—Ç–∫–∏? –ó–≤—É—á–∏—Ç —Ö–∞–π–ø–æ–≤–æ!')
    @commands.has_permissions(manage_channels=True)
    async def thread(self, inter: disnake.ApplicationCommandInteraction, action: str = commands.Param(choices=['–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª', '–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª']), *, channel: disnake.TextChannel):
        guild_id = inter.guild.id
        guild_name = inter.guild.name

        if action == '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª':
            cursor.execute('INSERT INTO autothread (guild_id, guild_name, channel_id) VALUES (?, ?, ?)', (guild_id, guild_name, channel.id))
            conn.commit()

            E = disnake.Embed(title='‚úÖ –ê–≤—Ç–æ–≤–µ—Ç–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã', color=0x84FE9A)
            E.add_field(name='–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞:', value=channel.mention)
            E.add_field(name='–î–µ–π—Å—Ç–≤–∏–µ:', value='```–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ –∫–∞–Ω–∞–ª –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤–µ—Ç–æ–∫.```')
            E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
            await inter.response.send_message(embed=E)

        elif action == '–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª':
            cursor.execute('SELECT channel_id FROM atembeds WHERE guild_id = ? AND channel_id = ?', (guild_id, channel.id))
            exc_channel_id = cursor.fetchone()

            if exc_channel_id is None:
                E = disnake.Embed(title='‚ö†Ô∏è –û—à–∏–±–æ—á–∫–∞ –≤—ã—à–ª–∞!', color=0xe52f07)
                E.add_field(name='–ü–æ—á–µ–º—É —è –≤–∞—Å –¥–∏–Ω–∞–º–ª—é?..', value=f'```–£–∫–∞–∑–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–∞–Ω–∞–ª–æ–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤–µ—Ç–æ–∫.```')
                E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
                await inter.response.send_message(embed=E, ephemeral=True)
                return
            else:
                cursor.execute('DELETE FROM atembeds WHERE guild_id = ? AND channel_id = ?', (guild_id, channel.id))
                conn.commit()

                E = disnake.Embed(title='üö´ –ê–≤—Ç–æ–≤–µ—Ç–∫–∏ —É–¥–∞–ª–µ–Ω—ã.', color=0xe52f07)
                E.add_field(name='–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã:', value=f'```–£–∫–∞–∑–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤–µ—Ç–æ–∫ –±—ã–ª —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω.```')
                E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
                await inter.response.send_message(embed=E)
                return
            
    @settings.sub_command(name='autothread-embed', description='–î–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º —ç–º–±–µ–¥ –≤–∞–º –ø–æ –≤–∫—É—Å—É!')
    @commands.has_permissions(manage_channels=True)
    async def atembeds(self, inter: disnake.ApplicationCommandInteraction, action: str = commands.Param(choices=['–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å', '–£–¥–∞–ª–∏—Ç—å']), *, channel: disnake.TextChannel, name: str = None, title: str = None, description: str = None, color: str = None):
        if action == '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å' and name != None and title != None and color != None:
            cursor.execute('SELECT channel_id FROM atembed WHERE guild_id = ? AND channel_id = ?', (inter.guild.id, channel.id))
            check = cursor.fetchone()

            if check:
                cursor.execute('DELETE FROM atembed WHERE guild_id = ? AND channel_id = ?', (inter.guild.id, channel.id))
                conn.commit()

            cursor.execute('INSERT INTO atembed (guild_id, guild_name, channel_id, name, title, description, color) VALUES (?, ?, ?, ?, ?, ?, ?)', (inter.guild.id, inter.guild.name, channel.id, name, title, description, color))
            conn.commit()

            E = disnake.Embed(title='‚úÖ –≠–º–±–µ–¥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!', color=0x84FE9A)
            E.add_field(name='–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞:', value=channel.mention)
            E.add_field(name='–î–µ–π—Å—Ç–≤–∏–µ:', value='```–ó–∞–≥–æ–ª–æ–≤–æ–∫, –û–ø–∏—Å–∞–Ω–∏–µ –∏ –¶–≤–µ—Ç —ç–º–±–µ–¥–∞ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –≤–µ—Ç–∫–∏.```')
            E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
            await inter.response.send_message(embed=E)
        
        if action == '–£–¥–∞–ª–∏—Ç—å' and name == None and title == None and description == None and color == None:
            cursor.execute('SELECT channel_id FROM atembed WHERE guild_id = ? AND channel_id = ?', (inter.guild.id, channel.id))
            exc_channel_id = cursor.fetchone()

            if exc_channel_id is None:
                E = disnake.Embed(title='‚ö†Ô∏è –û—à–∏–±–æ—á–∫–∞ –≤—ã—à–ª–∞!', color=0xe52f07)
                E.add_field(name='–ü–æ—á–µ–º—É —è –≤–∞—Å –¥–∏–Ω–∞–º–ª—é?..', value=f'```–£–∫–∞–∑–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–∞–Ω–∞–ª–æ–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤–µ—Ç–æ–∫.```')
                E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
                await inter.response.send_message(embed=E, ephemeral=True)
                return
            else:
                cursor.execute('DELETE FROM atembed WHERE guild_id = ? AND channel_id = ?', (inter.guild.id, channel.id))
                conn.commit()

                E = disnake.Embed(title='üö´ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ.', color=0xe52f07)
                E.add_field(name='–û—Ç–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã:', value=f'```–£–∫–∞–∑–∞–Ω–Ω–æ–µ —Ä–∞–Ω–µ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–º–µ–Ω–µ–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º.```')
                E.set_footer(text=random.choice(footer), icon_url=self.bot.user.avatar)
                await inter.response.send_message(embed=E)
                return

def setup(bot: commands.Bot):
    bot.add_cog(SettingsCog(bot))